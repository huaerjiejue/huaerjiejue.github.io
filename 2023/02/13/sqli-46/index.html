<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> sqli-46 · 小阔的bug日常</title><meta name="description" content="sqli-46 - 小阔"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://huaerjiejue.github.io/atom.xml" title="小阔的bug日常"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="小阔的bug日常" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">sqli-46</h1><div class="post-info">2023年2月13日</div><div class="post-content"><p>过了几天，又回来打sqli-labs了，这次是第46关，虽然期末考试在即，也不能慌，今天上课看到偶然记下的比价，比较有感悟：无事心不空，有事心不慌，大事心不惧，小事心不满。我想，虽然短短几句话，要实际做到这样，也是很难，如果真的有可以做到这样的，那么应该是大师了吧。反正我现在的心境就是，没有事情心里很空，有了事情心里很慌，大事害怕，小事怠慢，希望自己慢慢朝着这个方向努力吧。好了不瞎说了，下面是今天的解体：</p>
<p>  首先，映入眼帘的它让我们输入sort，这个sort就是排序的意思，所以说懂一些英文真的很重要，我一开始就对着这个sort一顿order by<img src="https://cdn.staticaly.com/gh/huaerjiejue/pic_of_myweb@master/image.1kg0nja3edpc.webp" alt="image"></p>
<p>  好的，我们输入sort&#x3D;1进行执行，列出一个表，然后我们通过一顿order by发现根本不同，这是为什么呢？假设我们不知道这个sort的意思，我们可以尝试将1换成2吗，这种情况下我们再分析一下，下面分别是1和2的情况：</p>
<img src="https://cdn.staticaly.com/gh/huaerjiejue/pic_of_myweb@master/image.xn4ge0h4wjk.webp" alt="image" style="zoom:50%;" />

<img src="https://cdn.staticaly.com/gh/huaerjiejue/pic_of_myweb@master/image.3rnjaamx4wa0.webp" alt="image" style="zoom:50%;" />

<p>我们发现两者的顺序不同，这就有趣了，我们再通过对比，发现sort等于1的时候是按照id排序的，sort等于2的时候是按照username进行排序的。我们这时候就很难不将sort和order by联系起来了。我们接着输入3和4，发现有3列，虽然可以直接通过表格显示出来。然后我们联合注入一下，使用union，发现似乎行不通，网页把union，order限制了<img src="https://cdn.staticaly.com/gh/huaerjiejue/pic_of_myweb@master/image.1lcev0eyf4kg.webp" alt="image" style="zoom: 80%;" /></p>
<p>顺便说一下前面测试就可以发现这个sort是数字型注入，也就是说没有符号包裹，既然他们过滤了union，我们不妨换个思路，使用报错，毕竟是他们报错告诉我们不能用union的。</p>
<p>  成功报错，由此我们就得到了一些信息，但是之后发现无论如何都进行不了堆叠注入,这就奇怪了,整个第三大关就是堆叠注入啊,居然没有地方可以进行,于是很自然地去网上搜索,发现这关果然没有,但是发现了一个文件的导入和导出,想到以前有过这关,却没有通过,因此也想试一试,构造payload:</p>
<p><code>http://172.25.176.1/sqli-labs-master/Less-46/``?sort=3 into outfile &quot;D:/text.txt&quot;</code></p>
<p>发现报错,The MySQL server is running with the –secure-file-priv option so it cannot execute this statement,经过查询,时mysql的文件导入导出功能没有开,正常情况下没有开我们是无法进行文件的相关操作的,但是这是为了演示,我们就把它打开了,通过修改文件mysql中的my.ini,添加一行代码<code>secure_file_priv=&#39;&#39;</code>然后进行保存重启,再次进行文件的导入,发现成功,<img src="https://cdn.staticaly.com/gh/huaerjiejue/pic_of_myweb@master/image.6zjnhnejsvs0.webp" alt="image"></p>
<p>至此这关的艰辛历程也算是过来了.</p>
</div></article></div></main><footer><div class="paginator"><a href="/2023/02/16/%E5%85%B3%E4%BA%8Epython%E4%B8%ADbeautifulsoup%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/" class="prev">PREV</a><a href="/2023/02/04/sqli-41/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2023 <a href="https://huaerjiejue.github.io">小阔</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>